#just in case
source("complete.R")

corr <- function(directory, threshold = 0) {
	valu <- vector(mode="numeric")
	completes <- complete(directory)
	validids <- completes[completes[,2] > threshold,1]
	for(i in validids) {
		## concatenate to achieve appropriate filenames
		prefix <- ""
		if(i < 100) {
			prefix<- "0"
		}
		if(i < 10) {
			prefix<-"00"
		}
		filename <- paste(directory,"/",prefix,toString(i[1]),".csv", sep="")
		## read single monitor data
		monitordata <- read.csv(filename)
		valu<- c(valu,cor(monitordata$sulfate,monitordata$nitrate,na.rm=TRUE))
	}
	return(valu)	
}
